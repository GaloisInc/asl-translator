# Overview

This repository implements a translation of the [ARM Semantic Language (ASL)][fn:asl-description] 
into a closed [What4][fn:what4] expression using the [Crucible][fn:crucible] symbolic execution library.

The ASL source is extracted from the official [XML specifications from ARM][fn:arm-specs] using 
a set of [tools][fn:mra_tools] developed by Alastair Reid. This source text is converted into a 
parse tree by the [asl parser][fn:asl-parser], which is the representation used by this tool.

# Running

The translator can be run via cabal with `cabal v2-run asl-translator`. The default options
will use the source files in `data/Parsed` to build a collection of serialized what4 expressions representing
the instructions and helper functions for the `A32` and `T32` instructions. By default these
are written out to `./output/formulas.what4`.

The default `make` target will use cabal to run the translator, but also can build the source files in 
`data` from the source ARM XML specification (via the `Makefile` in the `arm-asl-parser` subrepository).

# Source Files

## ASL Source

The `data` subdirectory contains 5 asl source files used for translation.

#### `arm_instrs.asl`

This file describes the semantics for each ARM instruction, including how to decode each instruction
from an opcode.

This translator is not concerned with decoding, and represents each instruction as a function from
its fields (as decoded operands) to a modification of the registers of the CPU.

#### `arm_defs.asl`

This file contains supporting definitions for auxiliary functions called by the instructions
defined in `arm_instrs.asl`.

#### `arm_regs.asl`

This file describes the system registers referred to by both `arm_defs.asl` and `arm_regs.asl`.

#### `support.asl`

This file is the concatenation of several support `asl` source files generated by `mra_tools`,
which provides stub definitions for functions whose semantics are implementation-defined.

#### `extra_defs.asl`

This is a manually written `asl` source file which overrides several functions from `arm_defs.asl`
as well as providing definitions for functions which are used internally by the translator.

## `Parsed`

The `Parsed` subdirectory contains the output of the `arm-asl-parser` tool on each of the
asl source files described above. These are s-expressions representing the parse tree of each file.


[fn:asl-description]: https://alastairreid.github.io/dissecting-ARM-MRA/
[fn:what4]: https://github.com/GaloisInc/crucible/tree/master/what4/
[fn:crucible]: https://github.com/GaloisInc/crucible
[fn:asl-parser]: https://github.com/GaloisInc/arm-asl-parser
[fn:mra_tools]: https://github.com/alastairreid/mra_tools
[fn:arm-specs]: https://developer.arm.com/architectures/cpu-architecture/a-profile/exploration-tools
